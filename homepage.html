<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alice's Reg - v7.2 Hub Fix</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Noto+Sans+SC:wght@300;500;900&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            /* ÊòºÊ®°ÂºèÂèòÈáè */
            --theme-bg: #fcfdfd;
            --theme-void-bg: #fdfcfb;
            --theme-text-primary: #1e293b;
            --theme-text-secondary: #94a3b8;
            --theme-hub-bg: rgba(255, 255, 255, 0.95);
            --theme-hub-text: #1e293b;
            --theme-border: rgba(0, 0, 0, 0.08);
            --theme-blob-mode: color-dodge;
            --theme-blob-opacity: 0.6;
            --theme-center-blob-opacity: 0.68;
            --theme-shadow: 0 4px 20px rgba(0, 0, 0, 0.02);
            --theme-title-gradient: linear-gradient(90deg, rgba(30, 41, 59, 0.98) 0%, rgba(100, 116, 139, 0.7) 25%, rgba(30, 41, 59, 0.98) 50%, rgba(100, 116, 139, 0.7) 75%, rgba(30, 41, 59, 0.98) 100%);
        }

        /* ÈªëÂ§úÊ®°ÂºèÂèòÈáè */
        [data-theme='night'] {
            --theme-bg: #0c0e14;
            --theme-void-bg: #0c0e14;
            --theme-text-primary: #f1f5f9;
            --theme-text-secondary: #64748b;
            --theme-hub-bg: rgba(215, 220, 230, 0.98);
            --theme-hub-text: #0f172a;
            --theme-border: rgba(255, 255, 255, 0.1);
            --theme-blob-mode: screen; 
            --theme-blob-opacity: 0.55;
            --theme-center-blob-opacity: 0.56;
            --theme-shadow: none; 
            --theme-title-gradient: linear-gradient(90deg, #ffffff 0%, #cbd5e1 25%, #ffffff 50%, #cbd5e1 75%, #ffffff 100%);
        }

        body {
            margin: 0;
            padding: 0;
            background-color: var(--theme-bg);
            font-family: 'Noto Sans SC', sans-serif;
            overflow: hidden;
            height: 100vh;
            width: 100vw;
            cursor: none; 
            transition: background-color 1s ease;
        }

        /* --- Èº†Ê†áË∑üÈöèÁ≥ªÁªü --- */
        #cursor-tip {
            position: fixed;
            width: 10px;
            height: 10px;
            pointer-events: none;
            z-index: 9999;
            background: linear-gradient(90deg, hsla(200, 90%, 85%, 1) 0%, hsla(260, 85%, 88%, 1) 25%, hsla(330, 90%, 85%, 1) 50%, hsla(160, 80%, 82%, 1) 75%, hsla(200, 90%, 85%, 1) 100%);
            background-size: 200% 100%;
            animation: lineShimmer 2s linear infinite;
            border-radius: 2px;
            transform-origin: center;
            will-change: transform;
        }

        #rabbit-follower {
            position: fixed;
            width: 42px;
            height: 42px;
            pointer-events: none;
            z-index: 9998;
            transform-origin: center;
            will-change: transform;
            display: flex;
            align-items: center;
            justify-content: center;
            filter: drop-shadow(0 4px 15px rgba(120, 130, 160, 0.6)); 
        }

        .rabbit-sprite-container { position: relative; width: 100%; height: 100%; }
        .rabbit-frame { position: absolute; inset: 0; width: 100%; height: 100%; opacity: 0; object-fit: contain; }
        .rabbit-frame.active { opacity: 1; }
        .rabbit-emoji { font-size: 26px; }

        /* --- ËßÜËßâË£ÖÈ•∞ --- */
        .system-inscription {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 10px;
            color: var(--theme-text-secondary);
            opacity: 0.6;
            letter-spacing: 0.02em;
            pointer-events: none;
            line-height: 1.4;
        }

        .site-tag-sub {
            font-family: "Microsoft Yahei UI Light", sans-serif;
            font-size: 15px; 
            color: var(--theme-text-secondary);
            opacity: 0.7;
            letter-spacing: 0.01em;
            pointer-events: none;
            margin-top: 5px;
            margin-left: 20px;
            white-space: nowrap;
            will-change: transform;
        }

        .title-underline {
            width: 120px;
            height: 2px;
            margin-top: 0px;
            background: linear-gradient(90deg, rgba(100, 149, 237, 0.7) 0%, rgba(138, 43, 226, 0.6) 25%, rgba(255, 105, 180, 0.5) 50%, rgba(72, 209, 204, 0.6) 75%, rgba(100, 149, 237, 0.7) 100%);
            background-size: 200% 100%;
            animation: lineShimmer 5s linear infinite;
            border-radius: 2px;
            opacity: 0.8;
            will-change: transform;
        }

        @keyframes lineShimmer { 0% { background-position: 100% 0%; } 100% { background-position: -100% 0%; } }

        .site-tag-title {
            font-family: 'Book Antiqua', serif;
            font-size: 40px; 
            font-weight: 900;
            line-height: 1.2;
            padding: 0 0 5px 0;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            pointer-events: auto; 
            cursor: pointer;
            background: var(--theme-title-gradient);
            background-size: 200% 100%;
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            text-fill-color: transparent;
            filter: drop-shadow(0 0 1px rgba(240, 248, 255, 0.05));
            animation: textShimmer 12s linear infinite;
            will-change: transform;
        }

        /* --- ËÉåÊôØÁ≥ªÁªü --- */
        #background-root { position: fixed; inset: 0; z-index: 0; background-color: var(--theme-void-bg); transition: background-color 1s ease; will-change: transform; }
        .aurora-container { position: absolute; inset: 0; overflow: hidden; pointer-events: none; z-index: 5; }
        .aurora-blob { position: absolute; border-radius: 50%; mix-blend-mode: var(--theme-blob-mode); transition: all 1s ease; }
        .colored-blob { filter: blur(100px); opacity: var(--theme-blob-opacity); }
        .blob-1 { width: 60vw; height: 60vw; bottom: -20%; left: -20%; animation: blob-move-1 25s infinite alternate ease-in-out, holo-shift-1 20s infinite alternate linear; }
        .blob-2 { width: 50vw; height: 50vw; bottom: -10%; left: -5%; animation: blob-move-2 22s infinite alternate ease-in-out, holo-shift-2 18s infinite alternate linear; }
        .blob-3 { width: 88vw; height: 88vw; top: 50%; left: 68%; transform: translate(-50%, -50%); z-index: 2; filter: blur(80px); opacity: var(--theme-center-blob-opacity); background-color: #ffffff; animation: blob-move-3 30s infinite alternate ease-in-out; }

        @keyframes holo-shift-1 { 0% { background-color: #ffdde1; } 50% { background-color: #f6d365; } 100% { background-color: #fda085; } }
        @keyframes holo-shift-2 { 0% { background-color: #84fab0; } 50% { background-color: #8fd3f4; } 100% { background-color: #a18cd1; } }
        @keyframes blob-move-1 { 0% { transform: translate(0, 0) scale(1); } 100% { transform: translate(-1vw, 1vh) scale(1.05); } }
        @keyframes blob-move-2 { 0% { transform: translate(0, 0) scale(1); } 100% { transform: translate(1vw, -1vh) scale(1.1); } }
        @keyframes blob-move-3 { 0% { transform: translate(-50%, -50%) scale(1); } 100% { transform: translate(-49%, -51%) scale(1.02); } }

        @keyframes texture-drift { 0% { background-position: 0 0; } 100% { background-position: 1000px -1000px; } }
        .star-sand-texture { position: absolute; inset: 0; z-index: 6; background-image: url('https://www.alicesreg.icu/Texture/bg/homepage/background-homepage-1.png'); background-size: 1022.5px; background-repeat: repeat; opacity: 1.0; mix-blend-mode: overlay; pointer-events: none; -webkit-mask-image: radial-gradient(circle at 0% 100%, black 0%, transparent 60%); mask-image: radial-gradient(circle at 0% 100%, black 0%, transparent 60%); animation: texture-drift 200s linear infinite; will-change: background-position; image-rendering: -webkit-optimize-contrast; }
        .noise-mask { position: absolute; inset: 0; z-index: 7; opacity: 0.035; pointer-events: none; }

        /* --- ÁöáÂÆ∂Ê°ÜÊû∂ --- */
        .frame-line { background-color: var(--theme-text-primary); position: fixed; z-index: 55; pointer-events: none; transition: background-color 1s ease; }
        .frame-line-h { height: 1px; left: 60px; right: 60px; animation: frame-expand-x 2.5s ease-out forwards; }
        .frame-line-v { width: 1px; top: 60px; bottom: 60px; animation: frame-expand-y 2.5s ease-out 0.3s forwards; opacity: 0; }
        @keyframes frame-expand-x { 0% { transform: scaleX(0); opacity: 0; } 100% { transform: scaleX(1); opacity: 0.6; } }
        @keyframes frame-expand-y { 0% { transform: scaleY(0); opacity: 0; } 100% { transform: scaleY(1); opacity: 0.6; } }
        .corner-symbol { position: fixed; width: 8px; height: 8px; z-index: 120; pointer-events: none; border-color: var(--theme-text-primary); transition: all 1s ease; }
        @keyframes rotate-cw { 0% { transform: rotate(45deg); } 100% { transform: rotate(405deg); } }
        @keyframes rotate-ccw { 0% { transform: rotate(45deg); } 100% { transform: rotate(-315deg); } }

        /* --- ‰∏áËä±Á≠íÊ†∏ÂøÉ --- */
        #kaleidoscope-wrapper { position: absolute; top: 50%; left: 68%; will-change: transform; transform: translate(-50%, -50%); }
        .slice-clip { clip-path: polygon(50% 50%, 100% 21.13%, 100% 78.87%); }
        .glass-morphism { background: transparent; border-right: none; transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1); -webkit-font-smoothing: antialiased; }
        .slice-container:hover .glass-morphism { transform: scale(1.02); }
        .hover-color-plate { position: absolute; inset: 0; z-index: 10; opacity: 0; backdrop-filter: blur(0px); -webkit-backdrop-filter: blur(0px); transition: opacity 0.8s cubic-bezier(0.16, 1, 0.3, 1), backdrop-filter 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
        .slice-container:hover .hover-color-plate { opacity: 0.7; backdrop-filter: blur(12px); }
        .slice-container.high-density-slice:hover .hover-color-plate { opacity: 0.9 !important; }

        .inner-border-svg { position: absolute; inset: 0; z-index: 15; pointer-events: none; overflow: visible; }
        .etching-line { fill: none; stroke-width: 0.375; stroke-linecap: round; stroke-dasharray: 200; stroke-dashoffset: 200; transition: stroke-dashoffset 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
        .slice-container:hover .etching-line { stroke-dashoffset: 0; }

        .fractal-layer { position: absolute; inset: 0; pointer-events: none; overflow: hidden; mix-blend-mode: normal; opacity: 1.0; z-index: 1; }
        .fractal-half { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; }
        .fractal-spinner-main { position: absolute; top: 50%; left: 50%; width: 140%; height: 140%; margin-left: -70%; margin-top: -70%; z-index: 3; animation: spin-fractal 31.4s linear infinite; }
        .fractal-spinner-fire { position: absolute; top: 50%; left: 50%; width: 140%; height: 140%; margin-left: -70%; margin-top: -70%; z-index: 2; background-image: url('https://www.alicesreg.icu/Texture/bg/homepage/homepage-kaleidoscope-opal-firecolor-1.png'); background-size: 512px; background-repeat: repeat; opacity: 1.0; animation: spin-fractal-reverse 31.4s linear infinite; }
        .fractal-spinner-base { position: absolute; top: 50%; left: 50%; width: 140%; height: 140%; margin-left: -70%; margin-top: -70%; z-index: 1; background-image: url('https://www.alicesreg.icu/Texture/bg/homepage/homepage_kaleidoscope-bg.png'); background-size: 800px; background-repeat: repeat; opacity: 1.0; animation: spin-fractal 114.2s linear infinite; }

        @keyframes spin-fractal { from { transform: rotate(0deg); } to { transform: rotate(-360deg); } }
        @keyframes spin-fractal-reverse { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* --- v7.2 ‰∏≠ÂøÉÊû¢Á∫Ω‰øÆÂ§ç --- */
        /* Ê∑ªÂä† Flex Â±Ö‰∏≠„ÄÅTransition Âä®Êïà */
        #center-hub { 
            position: absolute; top: 50%; left: 68%; 
            will-change: transform, width, height; 
            transform: translate(-50%, -50%); 
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            transition: width 0.8s cubic-bezier(0.16, 1, 0.3, 1), height 0.8s cubic-bezier(0.16, 1, 0.3, 1);
            z-index: 50;
        }

        .hub-orb-flat { 
            border: 1px solid var(--theme-border); 
            background: var(--theme-hub-bg);
            box-shadow: var(--theme-shadow); 
            transition: all 1s ease;
        }
        .input-verify { background: rgba(0, 0, 0, 0.05); border: 1px solid rgba(0, 0, 0, 0.1); transition: all 0.4s ease; }
        .input-verify:focus { background: rgba(255, 255, 255, 0.9); border-color: #fca5a5; }
    </style>
</head>
<body>

    <!-- Èº†Ê†áË∑üÈöèÁ≥ªÁªü -->
    <div id="cursor-tip"></div>
    <div id="rabbit-follower">
        <div class="rabbit-sprite-container" id="rabbit-sprite">
            <span class="rabbit-emoji" id="rabbit-fallback">üêá</span>
        </div>
    </div>

    <!-- È°∂ÈÉ®Èì≠Êñá (Static) -->
    <div class="fixed z-[130] pointer-events-none" style="top: 6px; left: 40px;">
        <p class="system-inscription">
            Most scattered, yet most steadfast. most changeable, yet most stable.<br>
            most distant, yet closest. most fleeting, yet most eternal.
        </p>
    </div>

    <!-- ÁöáÂÆ∂Ê°ÜÊû∂ (Static) -->
    <div id="frame-border-container">
        <div class="frame-line frame-line-h" style="top: 40px;"></div>
        <div class="frame-line frame-line-h" style="bottom: 40px;"></div>
        <div class="frame-line frame-line-v" style="left: 40px;"></div>
        <div class="frame-line frame-line-v" style="right: 40px;"></div>
    </div>

    <!-- ÂõõËßíËè±ÂΩ¢ (Static) -->
    <div id="corner-symbols-container">
        <div class="corner-symbol border-2" style="top: 40px; left: 40px; margin-left: -4px; margin-top: -4px; animation: rotate-cw 4s linear infinite;"></div>
        <div class="corner-symbol" id="sym-2" style="top: 40px; right: 40px; margin-right: -4px; margin-top: -4px; animation: rotate-ccw 4s linear infinite;"></div>
        <div class="corner-symbol border-2" style="bottom: 40px; right: 40px; margin-right: -4px; margin-bottom: -4px; animation: rotate-ccw 4s linear infinite;"></div>
        <div class="corner-symbol" id="sym-4" style="bottom: 40px; left: 40px; margin-left: -4px; margin-bottom: -4px; animation: rotate-cw 4s linear infinite;"></div>
    </div>

    <!-- ËÉåÊôØÁ≥ªÁªü (Parallax Layer 1: Background) -->
    <div id="background-root">
        <div class="absolute inset-0 z-[1] pointer-events-none mix-blend-multiply opacity-20" 
             style="background: linear-gradient(to bottom, #ffffff, #dfe4ea);"></div>
        <div class="aurora-container">
            <div class="aurora-blob colored-blob blob-1"></div>
            <div class="aurora-blob colored-blob blob-2"></div>
            <div class="aurora-blob blob-3"></div>
        </div>
        <div class="star-sand-texture"></div>
        <svg class="noise-mask">
            <filter id="noiseFilter">
                <feTurbulence type="fractalNoise" baseFrequency="0.7" numOctaves="3" stitchTiles="stitch"/>
            </filter>
            <rect width="100%" height="100%" filter="url(#noiseFilter)"/>
        </svg>
    </div>

    <!-- ‰∏áËä±Á≠íÂÆπÂô® (Parallax Layer 2: Mid) -->
    <div id="kaleidoscope-wrapper">
        <div id="wheel" class="relative pointer-events-auto" style="width: min(120vh, 120vw); height: min(120vh, 120vw);">
        </div>
    </div>

    <!-- v7.2 ‰∏≠ÂøÉÊû¢Á∫Ω (Parallax Layer 2: Mid) - Â∑≤Ê∑ªÂä† Flex Â±Ö‰∏≠ -->
    <div id="center-hub" style="width: 130px; height: 130px;">
        <div id="hub-orb" class="absolute inset-0 rounded-full hub-orb-flat"></div>
        <div id="hub-content-default" class="relative z-10 text-center transition-all duration-500">
            <h2 id="hub-text-1" class="font-bold tracking-[0.25em] text-[10px] uppercase" style="color: var(--theme-hub-text);">Tea Party</h2>
            <div class="w-4 h-[1px] bg-slate-300 mx-auto my-1.5 opacity-40"></div>
            <h2 id="hub-text-2" class="font-light tracking-[0.2em] text-[8px] uppercase" style="color: #94a3b8;">Record</h2>
        </div>
        <div id="hub-content-open" class="hidden relative z-10 w-full px-8 flex flex-col items-center opacity-0 scale-95 transition-all duration-500">
            <div class="flex items-center gap-2 mb-6 text-slate-400">
                <i data-lucide="sparkles" class="w-3 h-3"></i>
                <span class="text-[9px] uppercase tracking-widest font-mono">Terminal Protocol</span>
            </div>
            <div class="w-full space-y-3">
                <input type="text" placeholder="Phrase 01" class="input-verify w-full rounded px-3 py-2 text-[10px] outline-none text-center text-slate-700">
                <input type="text" placeholder="Phrase 02" class="input-verify w-full rounded px-3 py-2 text-[10px] outline-none text-center text-slate-700">
            </div>
            <button class="mt-6 w-full bg-slate-900 text-white rounded py-2 text-[9px] uppercase tracking-widest font-bold hover:bg-slate-700 transition-colors">
                Verify
            </button>
        </div>
    </div>

    <!-- HUD Overlay -->
    <div class="fixed z-[60] flex flex-col items-start pointer-events-none" style="top: 50px; left: 60px;">
        <div id="para-title-main">
            <h1 id="site-title-trigger" class="site-tag-title">Alice's Reg</h1>
        </div>
        <div id="para-title-line">
            <div class="title-underline"></div>
        </div>
        <div id="para-title-sub">
            <p class="site-tag-sub">Not reflecting light, but reshaping form</p>
        </div>
    </div>

    <!-- Áä∂ÊÄÅ‰ø°ÊÅØ -->
    <div class="fixed z-[130] pointer-events-none flex flex-col items-end gap-1" style="bottom: 12px; right: 20px;">
        <p class="text-[9px] font-mono text-slate-400 animate-pulse uppercase tracking-widest text-right">System_Awaiting_User_Sync</p>
        <p class="text-[8px] font-mono text-slate-400 tracking-tighter opacity-80 text-right">VER: 7.2 [HUB_FIX]</p>
    </div>

    <script>
        // --- Ê†∏ÂøÉÂèòÈáè ---
        let currentTheme = 'day';
        let targetX = window.innerWidth / 2, targetY = window.innerHeight / 2;
        let rabbitX = targetX, rabbitY = targetY;
        let rabbitVX = 0, rabbitVY = 0;
        let orbitAngle = 0, orbitRadius = 0, isIdle = false;
        let lastTime = performance.now(), cursorSelfRotation = 0;
        let rabbitFrameMode = 'emoji', currentFrame = 1;
        const totalFrames = 6;
        const spriteBaseUrl = 'https://www.alicesreg.icu/Texture/Mouse/Rabbit/';

        // v7.1 Áâ©ÁêÜÈïúÂ§¥ÂèÇÊï∞
        let camX = 0, camY = 0; 
        let targetCamX = 0, targetCamY = 0; 
        
        const cursorTip = document.getElementById('cursor-tip');
        const rabbitFollower = document.getElementById('rabbit-follower');
        const rabbitSpriteContainer = document.getElementById('rabbit-sprite');
        const rabbitFallback = document.getElementById('rabbit-fallback');
        
        const elBackground = document.getElementById('background-root');
        const elKaleidoscope = document.getElementById('kaleidoscope-wrapper');
        const elCenterHub = document.getElementById('center-hub');
        const elTitleMain = document.getElementById('para-title-main');
        const elTitleLine = document.getElementById('para-title-line');
        const elTitleSub = document.getElementById('para-title-sub');

        function checkTheme(manual = false) {
            if (!manual) {
                const hour = new Date().getHours();
                currentTheme = (hour >= 6 && hour < 18) ? 'day' : 'night';
            }
            document.documentElement.setAttribute('data-theme', currentTheme);
            const sym2 = document.getElementById('sym-2');
            const sym4 = document.getElementById('sym-4');
            const isDay = currentTheme === 'day';
            if (isDay) {
                sym2.style.backgroundColor = '#000'; sym4.style.backgroundColor = '#000';
            } else {
                sym2.style.backgroundColor = '#fff'; sym4.style.backgroundColor = '#fff';
            }
        }

        const titleTrigger = document.getElementById('site-title-trigger');
        let eggTimer;
        titleTrigger.addEventListener('mouseenter', () => {
            eggTimer = setTimeout(() => { currentTheme = (currentTheme === 'day' ? 'night' : 'day'); checkTheme(true); }, 3140); 
        });
        titleTrigger.addEventListener('mouseleave', () => { clearTimeout(eggTimer); });

        const SLICES_DATA = [
            { title: "Ê∫∫Ê∞¥ÁöÑÊòüËæ∞", subtitle: "The Drowned Star", bg: "#0a1a2a", text: "#ff6b9d" },
            { title: "ÂØÜÂ∞ÅÁöÑÂÖâÊµÅ", subtitle: "The Sealed Lightflow", bg: "hsla(168, 55%, 65%, 1)", text: "#0f172a" },
            { title: "ÁáÉÁÉßÁöÑÈì∂Ê≤≥", subtitle: "The Burning Galaxy", bg: "hsl(274, 13%, 58%)", text: "#f9f8f2" },
            { title: "‰∏çËêΩÁöÑÈô®Êòü", subtitle: "The Neverfall Comet", bg: "#000814", text: "#FF4500" },
            { title: "Ê≤âÊÄùÁöÑÂ§©ÁΩë", subtitle: "The Contemplative Net", bg: "#5e7296", text: "#FFFFFF" },
            { title: "ÊÅ©ÂÖ∏ÁöÑË∞éË®Ä", subtitle: "The Grace Lies", bg: "#F0F8FF", text: "#002FA7" }
        ];

        function initRabbitSprites() {
            let loadedCount = 0;
            for (let i = 1; i <= totalFrames; i++) {
                const img = new Image();
                img.src = `${spriteBaseUrl}${i}.png`;
                img.className = `rabbit-frame frame-${i}`;
                img.onload = () => { loadedCount++; if (loadedCount === totalFrames) { rabbitFrameMode = 'sprite'; rabbitFallback.style.display = 'none'; } };
                rabbitSpriteContainer.appendChild(img);
            }
        }

        setInterval(() => {
            if (rabbitFrameMode !== 'sprite') return;
            document.querySelectorAll('.rabbit-frame').forEach(f => f.classList.remove('active'));
            currentFrame = (currentFrame >= totalFrames) ? 1 : currentFrame + 1;
            const activeFrame = document.querySelector(`.frame-${currentFrame}`);
            if (activeFrame) activeFrame.classList.add('active');
        }, 100);

        window.addEventListener('mousemove', (e) => {
            targetX = e.clientX; targetY = e.clientY; 
            isIdle = false; 
            
            const centerX = window.innerWidth / 2;
            const centerY = window.innerHeight / 2;
            targetCamX = (e.clientX - centerX) / 80; 
            targetCamY = (e.clientY - centerY) / 80;
        });
        
        let idleCheckTimer;
        window.addEventListener('mousemove', () => { clearTimeout(idleCheckTimer); idleCheckTimer = setTimeout(() => { isIdle = true; }, 200); });

        let currentRotation = 0, targetSpeed = 0.004, isPaused = false;
        const wheel = document.getElementById('wheel');
        const fractalSVG = `<svg class="fractal-spinner-main" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="iridescent-shine" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="rgba(100, 149, 237, 0.6)" /><stop offset="30%" stop-color="rgba(138, 43, 226, 0.5)" /><stop offset="60%" stop-color="rgba(255, 105, 180, 0.4)" /><stop offset="100%" stop-color="rgba(72, 209, 204, 0.5)" /></linearGradient></defs><g stroke="url(#iridescent-shine)" stroke-width="0.4" fill="none" stroke-opacity="0.7"><g stroke-opacity="0.4"><circle cx="100" cy="0" r="90" /><circle cx="100" cy="200" r="90" /><circle cx="0" cy="100" r="90" /><circle cx="200" cy="100" r="90" /></g><g stroke-width="0.15" stroke-opacity="0.5"><path d="M100 0 L100 200 M0 100 L200 100" /><circle cx="100" cy="100" r="50" /><circle cx="100" cy="100" r="30" /><path d="M50 50 L150 150 M150 50 L50 150" /></g><g stroke-width="0.2" stroke-opacity="0.6"><path d="M100 10 Q150 50 190 100 Q150 150 100 190 Q50 150 10 100 Q50 50 10 100" /><path d="M10 100 Q50 150 100 190 Q150 150 190 100 Q150 50 100 10 Q50 50 10 100" /></g><g stroke-width="0.4" stroke-opacity="0.8"><path d="M100 35 Q165 100 100 165 Q35 100 100 35" /><path d="M35 100 Q100 165 165 100 Q100 35 35 100" /></g><path d="M100 65 L135 120 L65 120 Z" stroke-width="0.4" stroke-opacity="0.7"/><path d="M100 135 L135 80 L65 80 Z" stroke-width="0.4" stroke-opacity="0.7"/></g></svg>`;

        function createSliceDOM(data, index) {
            const container = document.createElement('div');
            container.className = 'slice-container absolute inset-0 slice-clip pointer-events-auto origin-center transition-opacity duration-500';
            if (["ÊÅ©ÂÖ∏ÁöÑË∞éË®Ä", "Ê∫∫Ê∞¥ÁöÑÊòüËæ∞", "‰∏çËêΩÁöÑÈô®Êòü", "ÂØÜÂ∞ÅÁöÑÂÖâÊµÅ"].includes(data.title)) container.classList.add('high-density-slice');
            container.style.transform = `rotate(${index * 60}deg)`;
            const glassLayer = document.createElement('div');
            glassLayer.className = 'glass-morphism absolute inset-0 flex items-center justify-end overflow-hidden';
            glassLayer.innerHTML = `<div class="fractal-layer"><div class="fractal-half" style="clip-path: polygon(50% 50%, 100% 21.13%, 100% 50%);"><div class="fractal-spinner-base"></div><div class="fractal-spinner-fire"></div>${fractalSVG}</div><div class="fractal-half" style="clip-path: polygon(50% 50%, 100% 21.13%, 100% 50%); transform: scaleY(-1); transform-origin: 50% 50%;"><div class="fractal-spinner-base"></div><div class="fractal-spinner-fire"></div>${fractalSVG}</div></div><svg class="inner-border-svg" viewBox="0 0 200 200"><g stroke="${data.text}"><path class="etching-line" d="M115 100 L190 58" /><path class="etching-line" d="M115 100 L190 142" /><path class="etching-line" d="M190 58 L190 142" /></g></svg><div class="hover-color-plate" style="background:${data.bg}"></div><div class="counter-rotate-content flex flex-col items-center justify-center text-center w-64 mr-[10%] relative z-[20]" style="transform-style: preserve-3d; backface-visibility: hidden;"><h3 class="slice-h3 text-base font-bold tracking-[0.25em] uppercase leading-tight transition-colors duration-700" style="color: #334155; font-family: serif;">${data.title}</h3><p class="slice-p text-[9px] uppercase tracking-[0.3em] mt-1 opacity-40 font-mono transition-colors duration-700" style="color: #334155;">${data.subtitle}</p></div>`;
            container.appendChild(glassLayer);
            container.addEventListener('mouseenter', () => {
                isPaused = true; container.style.zIndex = '30';
                const h3 = glassLayer.querySelector('.slice-h3'); const p = glassLayer.querySelector('.slice-p');
                const fractals = glassLayer.querySelectorAll('.fractal-spinner-main g');
                if(h3) h3.style.color = data.text; if(p) p.style.color = data.text;
                fractals.forEach(f => { f.setAttribute('stroke', data.text); f.setAttribute('stroke-opacity', '0.85'); });
                glassLayer.querySelectorAll('.etching-line').forEach(l => { l.style.strokeDasharray = '100 100'; l.style.strokeDashoffset = '0'; });
            });
            container.addEventListener('mouseleave', () => {
                isPaused = false; container.style.zIndex = '10';
                const h3 = glassLayer.querySelector('.slice-h3'); const p = glassLayer.querySelector('.slice-p');
                const fractals = glassLayer.querySelectorAll('.fractal-spinner-main g');
                if(h3) h3.style.color = '#334155'; if(p) p.style.color = '#334155';
                fractals.forEach(f => { f.setAttribute('stroke', 'url(#iridescent-shine)'); f.setAttribute('stroke-opacity', '0.7'); });
                glassLayer.querySelectorAll('.etching-line').forEach(l => { l.style.strokeDashoffset = '100'; });
            });
            return container;
        }

        function animate() {
            const now = performance.now(); const dt = (now - lastTime) / 1000; lastTime = now;
            if (!isPaused) currentRotation += targetSpeed; 
            wheel.style.transform = `rotate(${currentRotation}deg)`;
            document.querySelectorAll('.counter-rotate-content').forEach((el, i) => { el.style.transform = `rotate(${-currentRotation - (i * 60)}deg)`; });
            cursorSelfRotation += 0.5;
            cursorTip.style.transform = `translate(${targetX}px, ${targetY}px) rotate(${cursorSelfRotation}deg) translate(-50%, -50%)`;
            const timeScale = dt * 60; const stiffness = 0.015 * timeScale; const damping = Math.pow(0.92, timeScale); 
            let ax = (targetX - rabbitX) * stiffness; let ay = (targetY - rabbitY) * stiffness;
            rabbitVX = (rabbitVX + ax) * damping; rabbitVY = (rabbitVY + ay) * damping;
            rabbitX += rabbitVX; rabbitY += rabbitVY;
            let finalX = rabbitX, finalY = rabbitY, rotation = 0;
            if (isIdle) {
                orbitRadius += (80 - orbitRadius) * 0.05 * timeScale; orbitAngle -= 2.0 * dt; 
                finalX += Math.cos(orbitAngle) * orbitRadius; finalY += Math.sin(orbitAngle) * orbitRadius;
                rotation = (orbitAngle * 180 / Math.PI) + 90;
            } else {
                orbitRadius += (0 - orbitRadius) * 0.1 * timeScale;
                finalX += Math.cos(orbitAngle) * orbitRadius; finalY += Math.sin(orbitAngle) * orbitRadius;
                if (Math.abs(rabbitVX) > 0.05 || Math.abs(rabbitVY) > 0.05) rotation = (Math.atan2(rabbitVY, rabbitVX) * 180 / Math.PI) + 90;
            }
            rabbitFollower.style.transform = `translate(${finalX}px, ${finalY}px) rotate(${rotation}deg)`;

            // v7.1: Parallax
            const camStiffness = 0.05 * timeScale;
            camX += (targetCamX - camX) * camStiffness;
            camY += (targetCamY - camY) * camStiffness;

            elBackground.style.transform = `translate3d(${camX * 0.5}px, ${camY * 0.5}px, 0)`;

            // v7.1 FIX: Restore transform centering manually
            const midX = camX * 1.0; const midY = camY * 1.0;
            const centerTransform = `translate(-50%, -50%) translate3d(${midX}px, ${midY}px, 0)`;
            elKaleidoscope.style.transform = centerTransform; 
            elCenterHub.style.transform = centerTransform;

            elTitleMain.style.transform = `translate3d(${camX * 1.5}px, ${camY * 1.5}px, 0)`;
            elTitleLine.style.transform = `translate3d(${camX * 1.2}px, ${camY * 1.2}px, 0)`;
            elTitleSub.style.transform = `translate3d(${camX * 0.8}px, ${camY * 0.8}px, 0)`;

            requestAnimationFrame(animate);
        }

        const hub = document.getElementById('center-hub');
        const defaultContent = document.getElementById('hub-content-default');
        const openContent = document.getElementById('hub-content-open');
        hub.addEventListener('mouseenter', () => {
            isPaused = true; hub.style.width = '360px'; hub.style.height = '360px';
            defaultContent.style.opacity = '0';
            setTimeout(() => { defaultContent.classList.add('hidden'); openContent.classList.remove('hidden'); setTimeout(() => { openContent.style.opacity = '1'; openContent.style.transform = 'scale(1)'; }, 50); }, 300);
        });
        hub.addEventListener('mouseleave', () => {
            isPaused = false; hub.style.width = '130px'; hub.style.height = '130px';
            openContent.style.opacity = '0'; openContent.style.transform = 'scale(0.95)';
            setTimeout(() => { openContent.classList.add('hidden'); defaultContent.classList.remove('hidden'); setTimeout(() => { defaultContent.style.opacity = '1'; }, 50); }, 300);
        });

        checkTheme(); initRabbitSprites();
        SLICES_DATA.forEach((data, i) => wheel.appendChild(createSliceDOM(data, i)));
        lucide.createIcons(); animate();
    </script>
</body>
</html>
