<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Alice's Reg - v9.41 Vercel Ready</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&family=Noto+Sans+SC:wght@300;500;900&display=swap" rel="stylesheet">
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            /* æ˜¼æ¨¡å¼å˜é‡ */
            --theme-bg: #fcfdfd;
            --theme-void-bg: #fdfcfb;
            --theme-text-primary: #1e293b;
            --theme-text-secondary: #94a3b8;
            --theme-hub-bg: rgba(255, 255, 255, 0.95);
            --theme-hub-text: #1e293b;
            --theme-border: rgba(0, 0, 0, 0.08);
            --theme-blob-mode: color-dodge;
            --theme-blob-opacity: 0.6;
            --theme-center-blob-color: #ffffff;
            --theme-center-blob-mode: color-dodge;
            --theme-center-blob-opacity: 0.48;
            --theme-shadow: 0 4px 20px rgba(0, 0, 0, 0.02);
            --theme-title-gradient: linear-gradient(90deg, rgba(30, 41, 59, 0.98) 0%, rgba(100, 116, 139, 0.7) 25%, rgba(30, 41, 59, 0.98) 50%, rgba(100, 116, 139, 0.7) 75%, rgba(30, 41, 59, 0.98) 100%);
            /* v9.21: æ¿€æ´»æ€æµå…‰ - å¼ºåˆ¶åŒ…å«é»‘è‰²åº•è‰²å‚æ•° */
            --theme-active-text-gradient: linear-gradient(90deg, #1e293b 0%, #64748b 25%, #0f172a 50%, #475569 75%, #1e293b 100%);
        }

        /* é»‘å¤œæ¨¡å¼å˜é‡ */
        [data-theme='night'] {
            --theme-bg: #0c0e14;
            --theme-void-bg: #0c0e14;
            --theme-text-primary: #f1f5f9;
            --theme-text-secondary: #64748b;
            --theme-hub-bg: rgba(215, 220, 230, 0.98);
            --theme-hub-text: #0f172a;
            --theme-border: rgba(255, 255, 255, 0.1);
            --theme-blob-mode: screen; 
            --theme-blob-opacity: 0.385;
            --theme-center-blob-color: #ffffff;
            --theme-center-blob-mode: screen;
            --theme-center-blob-opacity: 0.7; 
            --theme-shadow: none; 
            --theme-title-gradient: linear-gradient(90deg, #ffffff 0%, #94a3b8 25%, #ffffff 50%, #94a3b8 75%, #ffffff 100%);
        }

        body {
            margin: 0; padding: 0; background-color: var(--theme-bg);
            font-family: 'Noto Sans SC', sans-serif; overflow: hidden;
            height: 100vh; width: 100vw; cursor: none; 
            transition: background-color 1s ease;
        }

        /* --- Loading Screen --- */
        #loading-overlay {
            position: fixed; inset: 0; z-index: 99999;
            background-color: #ffffff;
            display: flex; align-items: center; justify-content: center;
            transition: opacity 1s ease-out, visibility 1s ease-out;
        }
        .loading-text {
            font-family: 'Courier New', monospace;
            font-weight: 900; font-size: 14px; color: #1e293b;
            letter-spacing: 0.25em; text-transform: uppercase;
            animation: blink-text 0.15s infinite alternate;
        }
        @keyframes blink-text { 0% { opacity: 1; } 100% { opacity: 0.3; } }
        .fade-out { opacity: 0; visibility: hidden; pointer-events: none; }

        /* --- é¼ æ ‡è·Ÿéšç³»ç»Ÿ --- */
        #cursor-tip {
            position: fixed; width: 10px; height: 10px; pointer-events: none; z-index: 9999;
            background: linear-gradient(90deg, hsla(200, 90%, 85%, 1) 0%, hsla(260, 85%, 88%, 1) 25%, hsla(330, 90%, 85%, 1) 50%, hsla(160, 80%, 82%, 1) 75%, hsla(200, 90%, 85%, 1) 100%);
            background-size: 200% 100%; animation: lineShimmer 2s linear infinite; border-radius: 2px;
            transform-origin: center; will-change: transform;
        }

        #rabbit-follower {
            position: fixed; width: 42px; height: 42px; pointer-events: none; z-index: 9998;
            transform-origin: center; will-change: transform; display: flex; align-items: center; justify-content: center;
            filter: drop-shadow(0 4px 15px rgba(120, 130, 160, 0.6)); 
        }

        .rabbit-sprite-container { position: relative; width: 100%; height: 100%; }
        .rabbit-frame { position: absolute; inset: 0; width: 100%; height: 100%; opacity: 0; object-fit: contain; }
        .rabbit-frame.active { opacity: 1; }
        .rabbit-emoji { font-size: 26px; }

        /* --- è§†è§‰è£…é¥° --- */
        .system-inscription {
            font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace;
            font-size: 10px; color: var(--theme-text-secondary); opacity: 0.6;
            letter-spacing: 0.02em; pointer-events: none; line-height: 1.4;
        }
        .site-tag-sub {
            font-family: "Microsoft Yahei UI Light", sans-serif; font-size: 15px; 
            color: var(--theme-text-secondary); opacity: 0.7; letter-spacing: 0.01em;
            pointer-events: none; margin-top: 5px; margin-left: 20px; white-space: nowrap; will-change: transform;
        }
        .title-underline {
            width: 120px; height: 2px; margin-top: 0px;
            background: linear-gradient(90deg, rgba(100, 149, 237, 0.7) 0%, rgba(138, 43, 226, 0.6) 25%, rgba(255, 105, 180, 0.5) 50%, rgba(72, 209, 204, 0.6) 75%, rgba(100, 149, 237, 0.7) 100%);
            background-size: 200% 100%; animation: lineShimmer 5s linear infinite; border-radius: 2px; opacity: 0.8; will-change: transform;
        }
        @keyframes lineShimmer { 0% { background-position: 100% 0%; } 100% { background-position: -100% 0%; } }

        .site-tag-title {
            font-family: 'Book Antiqua', serif; font-size: 40px; font-weight: 900; line-height: 1.2; padding: 0 0 5px 0;
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1); pointer-events: auto; cursor: pointer;
            background: var(--theme-title-gradient); background-size: 200% 100%; 
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
            background-clip: text; text-fill-color: transparent;
            filter: drop-shadow(0 0 1px rgba(240, 248, 255, 0.05)); 
            animation: textShimmer 12s linear infinite;
            will-change: background-position; 
        }

        /* --- èƒŒæ™¯ç³»ç»Ÿ v9.15 Fix --- */
        #background-root { position: fixed; inset: 0; z-index: 0; background-color: var(--theme-void-bg); transition: background-color 1s ease; will-change: transform; }
        .aurora-container { position: absolute; inset: 0; overflow: hidden; pointer-events: none; z-index: 5; }
        .aurora-blob { position: absolute; border-radius: 50%; mix-blend-mode: var(--theme-blob-mode); transition: all 1s ease; }
        .colored-blob { filter: blur(100px); opacity: var(--theme-blob-opacity); }
        
        /* v9.29 FIX: Added background colors for blobs */
        .blob-1 { 
            width: 70vw; height: 70vw; bottom: -35%; left: -35%; 
            background: radial-gradient(circle, rgba(160, 190, 255, 0.8) 0%, rgba(255, 255, 255, 0) 70%);
            animation: blob-move-1 25s infinite alternate ease-in-out, holo-shift-1 20s infinite alternate linear; 
        }
        .blob-2 { 
            width: 55vw; height: 55vw; bottom: -20%; left: -10%; 
            background: radial-gradient(circle, rgba(230, 200, 255, 0.8) 0%, rgba(255, 255, 255, 0) 70%);
            animation: blob-move-2 22s infinite alternate ease-in-out, holo-shift-2 18s infinite alternate linear; 
        }
        .blob-3 { width: 88vw; height: 88vw; top: 50%; left: 68%; transform: translate(-50%, -50%); z-index: 2; filter: blur(80px); opacity: var(--theme-center-blob-opacity); background: radial-gradient(circle, var(--theme-center-blob-color) 0%, var(--theme-center-blob-color) 30%, transparent 100%); mix-blend-mode: var(--theme-center-blob-mode); animation: blob-move-3 30s infinite alternate ease-in-out; transition: all 1s ease; }

        @keyframes texture-drift { 0% { background-position: 0 0; } 100% { background-position: 1000px -1000px; } }
        
        .star-sand-texture { position: absolute; inset: 0; z-index: 6; background-image: url('https://www.alicesreg.icu/Texture/bg/homepage/background-homepage-1.png'); background-size: 1022.5px; background-repeat: repeat; opacity: 1.0; mix-blend-mode: overlay; pointer-events: none; -webkit-mask-image: radial-gradient(circle at 0% 100%, black 0%, transparent 60%); mask-image: radial-gradient(circle at 0% 100%, black 0%, transparent 60%); animation: texture-drift 200s linear infinite; will-change: background-position; image-rendering: -webkit-optimize-contrast; }
        .noise-mask { position: absolute; inset: 0; z-index: 7; opacity: 0.035; pointer-events: none; }

        /* --- çš‡å®¶æ¡†æ¶ --- */
        .frame-line { background-color: var(--theme-text-primary); position: fixed; z-index: 55; pointer-events: none; transition: background-color 1s ease; }
        .frame-line-h { height: 1px; left: 60px; right: 60px; animation: frame-expand-x 2.5s ease-out forwards; }
        .frame-line-v { width: 1px; top: 60px; bottom: 60px; animation: frame-expand-y 2.5s ease-out 0.3s forwards; opacity: 0; }
        @keyframes frame-expand-x { 0% { transform: scaleX(0); opacity: 0; } 100% { transform: scaleX(1); opacity: 0.85; } }
        @keyframes frame-expand-y { 0% { transform: scaleY(0); opacity: 0; } 100% { transform: scaleY(1); opacity: 0.85; } }
        .corner-symbol { position: fixed; width: 8px; height: 8px; z-index: 120; pointer-events: none; border-color: var(--theme-text-primary); transition: all 1s ease; }
        @keyframes rotate-cw { 0% { transform: rotate(45deg); } 100% { transform: rotate(405deg); } }
        @keyframes rotate-ccw { 0% { transform: rotate(45deg); } 100% { transform: rotate(-315deg); } }

        /* --- ç²’å­ç³»ç»Ÿ CSS --- */
        .particle-canvas { position: fixed; inset: 0; pointer-events: none; z-index: auto; }
        #particles-bg { z-index: 20; }
        #particles-fg { z-index: 80; }

        /* --- ä¸‡èŠ±ç­’æ ¸å¿ƒ --- */
        #kaleidoscope-wrapper { position: absolute; top: 50%; left: 68%; will-change: transform; transform: translate(-50%, -50%); z-index: 40; }
        .slice-clip { clip-path: polygon(50% 50%, 100% 21.13%, 100% 78.87%); }
        .glass-morphism { background: transparent; border-right: none; transition: all 0.6s cubic-bezier(0.16, 1, 0.3, 1); -webkit-font-smoothing: antialiased; }
        .slice-container:hover .glass-morphism { transform: scale(1.02); }
        .hover-color-plate { position: absolute; inset: 0; z-index: 10; opacity: 0; backdrop-filter: blur(0px); -webkit-backdrop-filter: blur(0px); transition: opacity 0.8s cubic-bezier(0.16, 1, 0.3, 1), backdrop-filter 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
        .slice-container:hover .hover-color-plate { opacity: 0.7; backdrop-filter: blur(12px); }
        .slice-container.high-density-slice:hover .hover-color-plate { opacity: 0.9 !important; }

        .inner-border-svg { position: absolute; inset: 0; z-index: 15; pointer-events: none; overflow: visible; }
        .etching-line { fill: none; stroke-width: 0.375; stroke-linecap: round; stroke-dasharray: 200; stroke-dashoffset: 200; transition: stroke-dashoffset 0.8s cubic-bezier(0.16, 1, 0.3, 1); }
        .slice-container:hover .etching-line { stroke-dashoffset: 0; }

        .fractal-layer { position: absolute; inset: 0; pointer-events: none; overflow: hidden; mix-blend-mode: normal; opacity: 1.0; z-index: 1; }
        .fractal-half { position: absolute; top: 0; left: 0; width: 100%; height: 100%; overflow: hidden; }
        .fractal-spinner-main { position: absolute; top: 50%; left: 50%; width: 140%; height: 140%; margin-left: -70%; margin-top: -70%; z-index: 3; animation: spin-fractal 31.4s linear infinite; }
        .fractal-spinner-fire { position: absolute; top: 50%; left: 50%; width: 140%; height: 140%; margin-left: -70%; margin-top: -70%; z-index: 2; background-image: url('https://www.alicesreg.icu/Texture/bg/homepage/homepage-kaleidoscope-opal-firecolor-1.png'); background-size: 512px; background-repeat: repeat; opacity: 1.0; animation: spin-fractal-reverse 104s linear infinite; }
        .fire-texture-rotor { position: absolute; top: -50%; left: -50%; width: 200%; height: 200%; background-image: url('https://www.alicesreg.icu/Texture/bg/homepage/homepage-kaleidoscope-opal-firecolor-2.png'); background-size: 600px; background-repeat: repeat; opacity: 1.0; mix-blend-mode: normal; transform-origin: 40% 40%; animation: spin-self 36s linear infinite; }
        .fractal-spinner-base { position: absolute; top: 50%; left: 50%; width: 140%; height: 140%; margin-left: -70%; margin-top: -70%; z-index: 1; background-image: url('https://www.alicesreg.icu/Texture/bg/homepage/homepage_kaleidoscope-bg.png'); background-size: 800px; background-repeat: repeat; opacity: 1.0; animation: spin-fractal 314s linear infinite; }

        @keyframes spin-fractal { from { transform: rotate(0deg); } to { transform: rotate(-360deg); } }
        @keyframes spin-fractal-reverse { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes spin-self { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }

        /* v9.15: Hide Slice Text Logic */
        .slice-h3, .slice-p { transition: opacity 0.5s ease; }
        .hub-open .slice-h3, .hub-open .slice-p { opacity: 0 !important; }

        /* ä¸­å¿ƒæ¢çº½ */
        #center-hub { 
            position: absolute; top: 50%; left: 68%; will-change: transform, width, height; transform: translate(-50%, -50%); 
            display: flex; align-items: center; justify-content: center; flex-direction: column;
            transition: width 0.8s cubic-bezier(0.16, 1, 0.3, 1), height 0.8s cubic-bezier(0.16, 1, 0.3, 1); z-index: 50;
        }
        /* v9.14: Hub Orb Border transition */
        .hub-orb-flat { border: 1px solid var(--theme-border); background: var(--theme-hub-bg); box-shadow: var(--theme-shadow); transition: all 0.6s ease; }
        
        /* v9.12: Bitmap Protocol è¾“å…¥æ¡† */
        .input-verify { 
            background: transparent; border: none; box-shadow: none; outline: none;
            width: 100%; height: 100%; text-align: center; font-family: 'Cinzel', serif;
            text-transform: uppercase; letter-spacing: 0.15em; color: #334155;
            z-index: 20; padding: 0;
        }
        /* v9.14: Placeholder 2x Larger */
        .input-verify::placeholder { color: rgba(51, 65, 85, 0.5); font-size: 20px; font-weight: 400; }
        .input-verify:focus { background: transparent; outline: none; }

        /* v9.34 FIX: Removed "!important" from color properties so animation can override them */
        .input-verify.input-activated {
            background-color: transparent !important;
            
            /* v9.37: Plain black color, no flash */
            color: #1e293b;
            -webkit-text-fill-color: #1e293b;
            
            background-image: none !important;
            
            filter: drop-shadow(0 0 3px rgba(0,0,0,0.15)) !important;
            font-weight: 900 !important;
            font-size: 33px !important; 
            font-family: 'Book Antiqua', serif !important;
            
            opacity: 1 !important; visibility: visible !important;
            pointer-events: none;
            z-index: 100 !important;
            
            position: absolute !important;
            width: 300px !important; 
            height: 100px !important;
            top: 50% !important; left: 50% !important;
            margin-left: -150px !important; margin-top: -50px !important; 
            padding: 0 !important;
            display: flex !important; align-items: center !important; justify-content: center !important;
        }

        /* v9.31: Top Name moved down 20px (-65px -> -45px) */
        @keyframes float-out-up {
            0% { transform: translateY(0px) scale(0.5); opacity: 0; }
            100% { transform: translateY(-45px) scale(1.3); opacity: 1; }
        }
        @keyframes float-out-left {
            0% { transform: translate(0px, 0px) scale(0.5); opacity: 0; }
            100% { transform: translate(-50px, 50px) scale(1.3); opacity: 1; }
        }
        @keyframes float-out-right {
            0% { transform: translate(0px, 0px) scale(0.5); opacity: 0; }
            100% { transform: translate(50px, 50px) scale(1.3); opacity: 1; }
        }

        /* v9.37 FIX: Removed flash-alice reference */
        .anim-float-up { 
            animation: float-out-up 1.75s cubic-bezier(0.19, 1, 0.22, 1) forwards !important; 
        }
        .anim-float-left { 
            animation: float-out-left 1.75s cubic-bezier(0.19, 1, 0.22, 1) forwards !important; 
        }
        .anim-float-right { 
            animation: float-out-right 1.75s cubic-bezier(0.19, 1, 0.22, 1) forwards !important; 
        }

        /* éšè—è¾“å…¥æ¡†åº•éƒ¨çš„å›¾ç‰‡å®¹å™¨ (åªéšè—å›¾ç‰‡ï¼Œä¸éšè—çˆ¶å®¹å™¨) */
        .container-hidden img { opacity: 0; transition: opacity 0.5s ease; }
        /* v9.29 FIX: Ensure container is visible for overflow */
        .container-hidden { overflow: visible !important; }

        /* æ¢çº½èƒŒæ™¯çº¹ç†åŠ¨ç”» */
        @keyframes spin-slow-cw { from { transform: rotate(0deg); } to { transform: rotate(360deg); } }
        @keyframes spin-slow-ccw { from { transform: rotate(0deg); } to { transform: rotate(-360deg); } }
        .animate-spin-slow-cw { animation: spin-slow-cw 60s linear infinite; }
        .animate-spin-slow-ccw { animation: spin-slow-ccw 45s linear infinite; }

        /* æ¿€æ´»å±‚è´´å›¾å¯¹é½ */
        .triangle-part { position: absolute; inset: 0; transition: opacity 0.5s ease; }
        .tri-inactive { opacity: 1; } .tri-active { opacity: 0; }
        .part-activated .tri-inactive { opacity: 0; } .part-activated .tri-active { opacity: 1; }
    </style>
</head>
<body>

    <div id="loading-overlay"> <div class="loading-text">Target:FOUND</div> </div>

    <div id="cursor-tip"></div>
    <div id="rabbit-follower">
        <div class="rabbit-sprite-container" id="rabbit-sprite"> <span class="rabbit-emoji" id="rabbit-fallback">ğŸ‡</span> </div>
    </div>

    <div class="fixed z-[130] pointer-events-none" style="top: 6px; left: 40px;">
        <p class="system-inscription">Most scattered, yet most steadfast. most changeable, yet most stable.<br>most distant, yet closest. most fleeting, yet most eternal.</p>
    </div>

    <div id="frame-border-container">
        <div class="frame-line frame-line-h" style="top: 40px;"></div>
        <div class="frame-line frame-line-h" style="bottom: 40px;"></div>
        <div class="frame-line frame-line-v" style="left: 40px;"></div>
        <div class="frame-line frame-line-v" style="right: 40px;"></div>
    </div>

    <div id="corner-symbols-container">
        <div class="corner-symbol border-2" style="top: 40px; left: 40px; margin-left: -4px; margin-top: -4px; animation: rotate-cw 4s linear infinite;"></div>
        <div class="corner-symbol" id="sym-2" style="top: 40px; right: 40px; margin-right: -4px; margin-top: -4px; animation: rotate-ccw 4s linear infinite;"></div>
        <div class="corner-symbol border-2" style="bottom: 40px; right: 40px; margin-right: -4px; margin-bottom: -4px; animation: rotate-ccw 4s linear infinite;"></div>
        <div class="corner-symbol" id="sym-4" style="bottom: 40px; left: 40px; margin-left: -4px; margin-bottom: -4px; animation: rotate-cw 4s linear infinite;"></div>
    </div>

    <div id="background-root">
        <div class="absolute inset-0 z-[1] pointer-events-none mix-blend-multiply opacity-15" style="background: linear-gradient(to bottom, #ffffff, #dfe4ea);"></div>
        <div class="aurora-container">
            <div class="aurora-blob colored-blob blob-1"></div>
            <div class="aurora-blob colored-blob blob-2"></div>
            <div class="aurora-blob blob-3"></div>
        </div>
        <div class="star-sand-texture"></div>
        <svg class="noise-mask">
            <filter id="noiseFilter"><feTurbulence type="fractalNoise" baseFrequency="0.7" numOctaves="3" stitchTiles="stitch"/></filter>
            <rect width="100%" height="100%" filter="url(#noiseFilter)"/>
        </svg>
    </div>

    <canvas id="particles-bg" class="particle-canvas"></canvas>

    <div id="kaleidoscope-wrapper">
        <div id="wheel" class="relative pointer-events-auto" style="width: min(120vh, 120vw); height: min(120vh, 120vw);"></div>
    </div>

    <div id="center-hub" style="width: 130px; height: 130px;">
        <div id="hub-orb" class="absolute inset-0 rounded-full hub-orb-flat"></div>
        <div id="hub-bg-layers" class="absolute inset-0 rounded-full overflow-hidden opacity-0 pointer-events-none transition-opacity duration-700">
            <img src="https://www.alicesreg.icu/Texture/UI/HomePage/homepage-teapartyrecord-bg-1.png" class="absolute inset-0 w-full h-full object-cover animate-spin-slow-cw" style="mix-blend-mode: multiply;">
            <img src="https://www.alicesreg.icu/Texture/UI/HomePage/homepage-teapartyrecord-bg-2.png" class="absolute inset-0 w-full h-full object-cover">
            <img src="https://www.alicesreg.icu/Texture/UI/HomePage/homepage-teapartyrecord-bg-3.png" class="absolute inset-0 w-full h-full object-cover animate-spin-slow-ccw" style="opacity: 0.8;">
        </div>

        <div id="hub-activation-layers" class="absolute inset-0 pointer-events-none z-15 transition-opacity duration-700 opacity-0 translate-x-[29px] translate-y-[15px]">
            <div id="part-up" class="absolute inset-0 w-full h-full">
                <img src="https://www.alicesreg.icu/Texture/UI/HomePage/TeaPartyRecord/realname-up-Inactive.png" class="triangle-part tri-inactive object-cover w-full h-full">
                <img src="https://www.alicesreg.icu/Texture/UI/HomePage/TeaPartyRecord/realname-up-Activated.png" class="triangle-part tri-active object-cover w-full h-full">
            </div>
            <div id="part-left" class="absolute inset-0 w-full h-full">
                <img src="https://www.alicesreg.icu/Texture/UI/HomePage/TeaPartyRecord/realname-left-Inactive.png" class="triangle-part tri-inactive object-cover w-full h-full">
                <img src="https://www.alicesreg.icu/Texture/UI/HomePage/TeaPartyRecord/realname-left-Activated.png" class="triangle-part tri-active object-cover w-full h-full">
            </div>
            <div id="part-right" class="absolute inset-0 w-full h-full">
                <img src="https://www.alicesreg.icu/Texture/UI/HomePage/TeaPartyRecord/realname-right-Inactive.png" class="triangle-part tri-inactive object-cover w-full h-full">
                <img src="https://www.alicesreg.icu/Texture/UI/HomePage/TeaPartyRecord/realname-right-Activated.png" class="triangle-part tri-active object-cover w-full h-full">
            </div>
        </div>

        <div id="hub-content-default" class="relative z-10 text-center transition-all duration-500">
            <h2 class="font-bold tracking-[0.25em] text-[10px] uppercase" style="color: var(--theme-hub-text);">Tea Party</h2>
            <div class="w-4 h-[1px] bg-slate-300 mx-auto my-1.5 opacity-40"></div>
            <h2 class="font-light tracking-[0.2em] text-[8px] uppercase" style="color: #94a3b8;">Record</h2>
        </div>

        <div id="hub-content-open" class="hidden relative z-20 w-full h-full opacity-0 scale-95 transition-all duration-500">
            <!-- v9.30: Top Input Slot - Raised by 20px (from -80px to -100px) -->
            <div class="absolute top-[10%] left-1/2 -translate-x-1/2 -translate-y-[100px] w-48">
                <div id="container-top" class="relative w-full flex items-center justify-center transition-opacity duration-700">
                    <img src="https://www.alicesreg.icu/Texture/UI/HomePage/homepage-inputbox-up.png" class="w-full object-contain pointer-events-none select-none drop-shadow-md">
                    <input id="input-top" type="text" placeholder="Who am I" class="input-verify absolute inset-0 w-full h-full px-4 text-[13px] outline-none text-center font-mono tracking-widest">
                </div>
            </div>
            <!-- Left Input Slot -->
            <div class="absolute bottom-[10%] left-[-15%] w-48">
                <div id="container-left" class="relative w-full flex items-center justify-center transition-opacity duration-700">
                    <img src="https://www.alicesreg.icu/Texture/UI/HomePage/homepage-inputbox-left.png" class="w-full object-contain pointer-events-none select-none drop-shadow-md">
                    <input id="input-left" type="text" placeholder="What I do" class="input-verify absolute inset-0 w-full h-full px-4 text-[13px] outline-none text-center font-mono tracking-widest">
                </div>
            </div>
            <!-- Right Input Slot -->
            <div class="absolute bottom-[10%] right-[-15%] w-48">
                <div id="container-right" class="relative w-full flex items-center justify-center transition-opacity duration-700">
                    <img src="https://www.alicesreg.icu/Texture/UI/HomePage/homepage-inputbox-right.png" class="w-full object-contain pointer-events-none select-none drop-shadow-md">
                    <input id="input-right" type="text" placeholder="How do I" class="input-verify absolute inset-0 w-full h-full px-4 text-[13px] outline-none text-center font-mono tracking-widest">
                </div>
            </div>
        </div>
    </div>

    <canvas id="particles-fg" class="particle-canvas"></canvas>

    <div class="fixed z-[60] flex flex-col items-start pointer-events-none" style="top: 50px; left: 60px;">
        <div id="para-title-main"><h1 id="site-title-trigger" class="site-tag-title">Alice's Reg</h1></div>
        <div id="para-title-line"><div class="title-underline"></div></div>
        <div id="para-title-sub"><p class="site-tag-sub">Not reflecting light, but reshaping form</p></div>
    </div>

    <div class="fixed z-[130] pointer-events-none flex flex-col items-end gap-1" style="bottom: 12px; right: 20px;">
        <p class="text-[9px] font-mono text-slate-400 animate-pulse uppercase tracking-widest text-right">System_Awaiting_User_Sync</p>
        <p id="version-tag" class="text-[8px] font-mono text-slate-400 tracking-tighter opacity-80 text-right">VER: 9.41 [VERCEL_READY]</p>
    </div>

    <script>
        let currentTheme = 'day', targetX = window.innerWidth / 2, targetY = window.innerHeight / 2;
        let rabbitX = targetX, rabbitY = targetY, rabbitVX = 0, rabbitVY = 0;
        let orbitAngle = 0, orbitRadius = 0, isIdle = false, lastTime = performance.now(), cursorSelfRotation = 0;
        let rabbitFrameMode = 'emoji', currentFrame = 1, totalFrames = 6;
        const spriteBaseUrl = 'https://www.alicesreg.icu/Texture/Mouse/Rabbit/';
        let camX = 0, camY = 0, targetCamX = 0, targetCamY = 0; 
        
        const cursorTip = document.getElementById('cursor-tip'), rabbitFollower = document.getElementById('rabbit-follower');
        const rabbitSpriteContainer = document.getElementById('rabbit-sprite'), rabbitFallback = document.getElementById('rabbit-fallback');
        const elBackground = document.getElementById('background-root'), elKaleidoscope = document.getElementById('kaleidoscope-wrapper');
        const elCenterHub = document.getElementById('center-hub'), elTitleMain = document.getElementById('para-title-main');
        const elTitleLine = document.getElementById('para-title-line'), elTitleSub = document.getElementById('para-title-sub');

        class ParticleSystem {
            constructor(canvasId, options) { this.canvas = document.getElementById(canvasId); this.ctx = this.canvas.getContext('2d'); this.particles = []; this.options = options; this.resize(); window.addEventListener('resize', () => this.resize()); }
            resize() { this.canvas.width = window.innerWidth; this.canvas.height = window.innerHeight; }
            getRandomColor() {
                if (currentTheme === 'day') { const g = 193 + Math.floor(Math.random() * 44), b = 110 + Math.floor(Math.random() * 4); return `rgb(255, ${g}, ${b})`; }
                else { const g = 141 + Math.floor(Math.random() * 19), b = 124 + Math.floor(Math.random() * 21); return `rgb(255, ${g}, ${b})`; }
            }
            spawn() {
                if (this.particles.length >= this.options.count) return;
                const x = Math.random() * (this.canvas.width * 0.4), baseHeight = this.canvas.height - (this.options.yOffset || 0), y = baseHeight + Math.random() * 50; 
                this.particles.push({ x: x, y: y, vx: this.options.speedMin + Math.random() * (this.options.speedMax - this.options.speedMin), vy: -(this.options.speedMin + Math.random() * (this.options.speedMax - this.options.speedMin)), size: this.options.sizeMin + Math.random() * (this.options.sizeMax - this.options.sizeMin), life: 1.0, decay: 0.002 + Math.random() * 0.003, color: this.getRandomColor() });
            }
            updateAndDraw() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);
                for (let i = this.particles.length - 1; i >= 0; i--) {
                    let p = this.particles[i]; p.x += p.vx; p.y += p.vy; p.life -= p.decay;
                    if (p.life <= 0) { this.particles.splice(i, 1); } 
                    else { this.ctx.fillStyle = p.color; this.ctx.globalAlpha = p.life * 0.8; this.ctx.beginPath(); this.ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2); this.ctx.fill(); }
                }
                this.ctx.globalAlpha = 1.0; if (Math.random() < 0.1) this.spawn(); 
            }
        }

        const particlesBg = new ParticleSystem('particles-bg', { count: 28, sizeMin: 0.8, sizeMax: 1.2, speedMin: 0.12, speedMax: 0.3, yOffset: 150 });
        const particlesFg = new ParticleSystem('particles-fg', { count: 21, sizeMin: 1.5, sizeMax: 2.5, speedMin: 0.48, speedMax: 0.9, yOffset: 50 });

        function checkTheme(manual = false) {
            if (!manual) { const hour = new Date().getHours(); currentTheme = (hour >= 6 && hour < 18) ? 'day' : 'night'; }
            document.documentElement.setAttribute('data-theme', currentTheme);
            const sym2 = document.getElementById('sym-2'), sym4 = document.getElementById('sym-4'), isDay = currentTheme === 'day';
            sym2.style.backgroundColor = isDay ? '#000' : '#fff'; sym4.style.backgroundColor = isDay ? '#000' : '#fff';
        }

        const titleTrigger = document.getElementById('site-title-trigger');
        let eggTimer;
        titleTrigger.addEventListener('mouseenter', () => { eggTimer = setTimeout(() => { currentTheme = (currentTheme === 'day' ? 'night' : 'day'); checkTheme(true); }, 3140); });
        titleTrigger.addEventListener('mouseleave', () => { clearTimeout(eggTimer); });

        const SLICES_DATA = [
            { title: "æººæ°´çš„æ˜Ÿè¾°", subtitle: "The Drowned Star", bg: "#0a1a2a", text: "#ff6b9d" },
            { title: "å¯†å°çš„å…‰æµ", subtitle: "The Sealed Lightflow", bg: "hsla(168, 55%, 65%, 1)", text: "#0f172a" },
            { title: "ç‡ƒçƒ§çš„é“¶æ²³", subtitle: "The Burning Galaxy", bg: "hsl(274, 13%, 58%)", text: "#f9f8f2" },
            { title: "ä¸è½çš„é™¨æ˜Ÿ", subtitle: "The Neverfall Comet", bg: "#000814", text: "#FF4500" },
            { title: "æ²‰æ€çš„å¤©ç½‘", subtitle: "The Contemplative Net", bg: "#5e7296", text: "#FFFFFF" },
            { title: "æ©å…¸çš„è°è¨€", subtitle: "The Grace Lies", bg: "#F0F8FF", text: "#002FA7" }
        ];

        function initRabbitSprites() {
            let loadedCount = 0;
            for (let i = 1; i <= totalFrames; i++) {
                const img = new Image(); img.src = `${spriteBaseUrl}${i}.png`; img.className = `rabbit-frame frame-${i}`;
                img.onload = () => { loadedCount++; if (loadedCount === totalFrames) { rabbitFrameMode = 'sprite'; rabbitFallback.style.display = 'none'; } };
                rabbitSpriteContainer.appendChild(img);
            }
        }

        setInterval(() => {
            if (rabbitFrameMode !== 'sprite') return;
            document.querySelectorAll('.rabbit-frame').forEach(f => f.classList.remove('active'));
            currentFrame = (currentFrame >= totalFrames) ? 1 : currentFrame + 1;
            const activeFrame = document.querySelector(`.frame-${currentFrame}`);
            if (activeFrame) activeFrame.classList.add('active');
        }, 100);

        window.addEventListener('mousemove', (e) => {
            targetX = e.clientX; targetY = e.clientY; isIdle = false; 
            const centerX = window.innerWidth / 2, centerY = window.innerHeight / 2;
            targetCamX = (e.clientX - centerX) / 80; targetCamY = (e.clientY - centerY) / 80;
        });
        
        let idleCheckTimer;
        window.addEventListener('mousemove', () => { clearTimeout(idleCheckTimer); idleCheckTimer = setTimeout(() => { isIdle = true; }, 200); });

        let currentRotation = 0, targetSpeed = 0.004, isPaused = false;
        const wheel = document.getElementById('wheel');
        const fractalSVG = `<svg class="fractal-spinner-main" viewBox="0 0 200 200" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="iridescent-shine" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="rgba(100, 149, 237, 0.6)" /><stop offset="30%" stop-color="rgba(138, 43, 226, 0.5)" /><stop offset="60%" stop-color="rgba(255, 105, 180, 0.4)" /><stop offset="100%" stop-color="rgba(72, 209, 204, 0.5)" /></linearGradient></defs><g stroke="url(#iridescent-shine)" stroke-width="0.4" fill="none" stroke-opacity="0.7"><g stroke-opacity="0.4"><circle cx="100" cy="0" r="90" /><circle cx="100" cy="200" r="90" /><circle cx="0" cy="100" r="90" /><circle cx="200" cy="100" r="90" /></g><g stroke-width="0.15" stroke-opacity="0.5"><path d="M100 0 L100 200 M0 100 L200 100" /><circle cx="100" cy="100" r="50" /><circle cx="100" cy="100" r="30" /><path d="M50 50 L150 150 M150 50 L50 150" /></g><g stroke-width="0.2" stroke-opacity="0.6"><path d="M100 10 Q150 50 190 100 Q150 150 100 190 Q50 150 10 100 Q50 50 10 100" /><path d="M10 100 Q50 150 100 190 Q150 150 190 100 Q150 50 100 10 Q50 50 10 100" /></g><g stroke-width="0.4" stroke-opacity="0.8"><path d="M100 35 Q165 100 100 165 Q35 100 100 35" /><path d="M35 100 Q100 165 165 100 Q100 35 35 100" /></g><path d="M100 65 L135 120 L65 120 Z" stroke-width="0.4" stroke-opacity="0.7"/><path d="M100 135 L135 80 L65 80 Z" stroke-width="0.4" stroke-opacity="0.7"/></g></svg>`;

        function createSliceDOM(data, index) {
            const container = document.createElement('div');
            container.className = 'slice-container absolute inset-0 slice-clip pointer-events-auto origin-center transition-opacity duration-500';
            if (["æ©å…¸çš„è°è¨€", "æººæ°´çš„æ˜Ÿè¾°", "ä¸è½çš„é™¨æ˜Ÿ", "å¯†å°çš„å…‰æµ"].includes(data.title)) container.classList.add('high-density-slice');
            container.style.transform = `rotate(${index * 60}deg)`;
            const glassLayer = document.createElement('div');
            glassLayer.className = 'glass-morphism absolute inset-0 flex items-center justify-end overflow-hidden';
            glassLayer.innerHTML = `<div class="fractal-layer"><div class="fractal-half" style="clip-path: polygon(50% 50%, 100% 21.13%, 100% 50%);"><div class="fractal-spinner-base"></div><div class="fractal-spinner-fire"><div class="fire-texture-rotor"></div></div>${fractalSVG}</div><div class="fractal-half" style="clip-path: polygon(50% 50%, 100% 21.13%, 100% 50%); transform: scaleY(-1); transform-origin: 50% 50%;"><div class="fractal-spinner-base"></div><div class="fractal-spinner-fire"><div class="fire-texture-rotor"></div></div>${fractalSVG}</div></div><svg class="inner-border-svg" viewBox="0 0 200 200"><g stroke="${data.text}"><path class="etching-line" d="M115 100 L190 58" /><path class="etching-line" d="M115 100 L190 142" /><path class="etching-line" d="M190 58 L190 142" /></g></svg><div class="hover-color-plate" style="background:${data.bg}"></div><div class="counter-rotate-content flex flex-col items-center justify-center text-center w-64 mr-[10%] relative z-[20]"><h3 class="slice-h3 text-base font-bold tracking-[0.25em] uppercase leading-tight transition-colors duration-700" style="color: #334155; font-family: serif;">${data.title}</h3><p class="slice-p text-[9px] uppercase tracking-[0.3em] mt-1 opacity-40 font-mono transition-colors duration-700" style="color: #334155;">${data.subtitle}</p></div>`;
            container.appendChild(glassLayer);
            container.addEventListener('mouseenter', () => { isPaused = true; container.style.zIndex = '30'; const h3 = glassLayer.querySelector('.slice-h3'), p = glassLayer.querySelector('.slice-p'), fractals = glassLayer.querySelectorAll('.fractal-spinner-main g'); if(h3) h3.style.color = data.text; if(p) p.style.color = data.text; fractals.forEach(f => { f.setAttribute('stroke', data.text); f.setAttribute('stroke-opacity', '0.85'); }); glassLayer.querySelectorAll('.etching-line').forEach(l => { l.style.strokeDasharray = '100 100'; l.style.strokeDashoffset = '0'; }); });
            container.addEventListener('mouseleave', () => { isPaused = false; container.style.zIndex = '10'; const h3 = glassLayer.querySelector('.slice-h3'), p = glassLayer.querySelector('.slice-p'), fractals = glassLayer.querySelectorAll('.fractal-spinner-main g'); if(h3) h3.style.color = '#334155'; if(p) p.style.color = '#334155'; fractals.forEach(f => { f.setAttribute('stroke', 'url(#iridescent-shine)'); f.setAttribute('stroke-opacity', '0.7'); }); glassLayer.querySelectorAll('.etching-line').forEach(l => { l.style.strokeDashoffset = '100'; }); });
            return container;
        }

        function animate() {
            const now = performance.now(), dt = (now - lastTime) / 1000; lastTime = now;
            if (!isPaused) currentRotation += targetSpeed; wheel.style.transform = `rotate(${currentRotation}deg)`;
            document.querySelectorAll('.counter-rotate-content').forEach((el, i) => { el.style.transform = `rotate(${-currentRotation - (i * 60)}deg)`; });
            cursorSelfRotation += 0.5; cursorTip.style.transform = `translate(${targetX}px, ${targetY}px) rotate(${cursorSelfRotation}deg) translate(-50%, -50%)`;
            const timeScale = dt * 60, stiffness = 0.015 * timeScale, damping = Math.pow(0.92, timeScale); 
            let ax = (targetX - rabbitX) * stiffness, ay = (targetY - rabbitY) * stiffness; rabbitVX = (rabbitVX + ax) * damping; rabbitVY = (rabbitVY + ay) * damping; rabbitX += rabbitVX; rabbitY += rabbitVY;
            let finalX = rabbitX, finalY = rabbitY, rotation = 0;
            if (isIdle) { orbitRadius += (80 - orbitRadius) * 0.05 * timeScale; orbitAngle -= 2.0 * dt; finalX += Math.cos(orbitAngle) * orbitRadius; finalY += Math.sin(orbitAngle) * orbitRadius; rotation = (orbitAngle * 180 / Math.PI) + 90; } 
            else { orbitRadius += (0 - orbitRadius) * 0.1 * timeScale; finalX += Math.cos(orbitAngle) * orbitRadius; finalY += Math.sin(orbitAngle) * orbitRadius; if (Math.abs(rabbitVX) > 0.05 || Math.abs(rabbitVY) > 0.05) rotation = (Math.atan2(rabbitVY, rabbitVX) * 180 / Math.PI) + 90; }
            rabbitFollower.style.transform = `translate(${finalX}px, ${finalY}px) rotate(${rotation}deg)`;
            const camStiffness = 0.05 * timeScale; camX += (targetCamX - camX) * camStiffness; camY += (targetCamY - camY) * camStiffness;
            elBackground.style.transform = `scale(1.1) translate3d(${camX * 0.15}px, ${camY * 0.15}px, 0)`; 
            const centerTransform = `translate(-50%, -50%) translate3d(${camX}px, ${camY}px, 0)`;
            elKaleidoscope.style.transform = centerTransform; elCenterHub.style.transform = centerTransform;
            elTitleMain.style.transform = `translate3d(${camX * 1.5}px, ${camY * 1.5}px, 0)`;
            elTitleLine.style.transform = `translate3d(${camX * 1.2}px, ${camY * 1.2}px, 0)`;
            elTitleSub.style.transform = `translate3d(${camX * 0.8}px, ${camY * 0.8}px, 0)`;
            particlesBg.updateAndDraw(); particlesFg.updateAndDraw(); requestAnimationFrame(animate);
        }

        const hub = document.getElementById('center-hub'), defaultContent = document.getElementById('hub-content-default'), openContent = document.getElementById('hub-content-open'), bgLayers = document.getElementById('hub-bg-layers'), hubOrb = document.getElementById('hub-orb'), activationLayers = document.getElementById('hub-activation-layers'), kaleidoWrapper = document.getElementById('kaleidoscope-wrapper');

        hub.addEventListener('mouseenter', () => { 
            isPaused = true; hub.style.width = '360px'; hub.style.height = '360px'; 
            document.getElementById('hub-content-default').style.opacity = '0';
            bgLayers.style.opacity = '1'; activationLayers.style.opacity = '1';
            hubOrb.style.borderColor = 'transparent'; kaleidoWrapper.classList.add('hub-open');
            setTimeout(() => { document.getElementById('hub-content-default').classList.add('hidden'); openContent.classList.remove('hidden'); setTimeout(() => { openContent.style.opacity = '1'; openContent.style.transform = 'scale(1)'; }, 50); }, 300); 
        });
        hub.addEventListener('mouseleave', () => { 
            isPaused = false; hub.style.width = '130px'; hub.style.height = '130px'; 
            openContent.style.opacity = '0'; openContent.style.transform = 'scale(0.95)'; 
            bgLayers.style.opacity = '0'; activationLayers.style.opacity = '0';
            hubOrb.style.borderColor = 'var(--theme-border)'; kaleidoWrapper.classList.remove('hub-open');
            setTimeout(() => { openContent.classList.add('hidden'); document.getElementById('hub-content-default').classList.remove('hidden'); setTimeout(() => { document.getElementById('hub-content-default').style.opacity = '1'; }, 50); }, 300); 
        });

        window.addEventListener('load', () => { const loader = document.getElementById('loading-overlay'); setTimeout(() => { loader.classList.add('fade-out'); setTimeout(() => { loader.remove(); }, 1000); }, 500); });

        // --- v9.41: Vercel Relative Path API Logic ---
        const PARTS = { 'input-top': 'part-up', 'input-left': 'part-left', 'input-right': 'part-right' };
        const CONTAINERS = { 'input-top': 'container-top', 'input-left': 'container-left', 'input-right': 'container-right' };
        const ANIM_CLASSES = { 'input-top': 'anim-float-up', 'input-left': 'anim-float-left', 'input-right': 'anim-float-right' };
        
        // è®°å½•å·²æ¿€æ´»çš„çœŸåæ•°é‡
        const activatedSet = new Set();
        let connectionErrorShown = false; 

        function debounce(func, wait) {
            let timeout;
            return function(...args) {
                clearTimeout(timeout);
                timeout = setTimeout(() => func.apply(this, args), wait);
            };
        }

        function setupInputLogic(id) {
            const input = document.getElementById(id);
            if (!input) return;

            input.addEventListener('input', debounce(async (e) => {
                const val = e.target.value.trim();
                // å¦‚æœé•¿åº¦ä¸å¤Ÿï¼Œå¤åŸçº¢è‰²è­¦å‘Š
                if (val.length < 3) {
                    input.style.color = '#334155';
                    return; 
                }

                // é‡ç‚¹ï¼šä½¿ç”¨ç›¸å¯¹è·¯å¾„ /api/verify
                // Vercel ä¼šè‡ªåŠ¨è·¯ç”±åˆ° api ç›®å½•
                try {
                    const response = await fetch('/api/verify', {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ positionId: id, text: val })
                    });
                    const result = await response.json();
                    
                    if (result.success) {
                        activateInput(id);
                    }
                } catch (err) {
                    console.error("API connection failed:", err);
                    // åªæœ‰åœ¨æœ¬åœ°æµ‹è¯•ä¸”æ²¡è·‘åç«¯æ—¶æ‰å¼¹çª—ï¼Œçº¿ä¸Šä¸€èˆ¬ä¸ä¼šæŒ‚
                    if (window.location.hostname === 'localhost' && !connectionErrorShown) {
                        input.style.color = 'red';
                        alert("ğŸ”´ è¿æ¥å¤±è´¥ï¼è¯·ç¡®ä¿æœ¬åœ°å¼€å‘ç¯å¢ƒ api æ–‡ä»¶å¤¹æ­£ç¡®ã€‚");
                        connectionErrorShown = true;
                    }
                }
            }, 500)); 
        }

        function activateInput(id) {
            const input = document.getElementById(id), part = document.getElementById(PARTS[id]), container = document.getElementById(CONTAINERS[id]);
            if (input.classList.contains('input-activated')) return;
            
            input.classList.add('input-activated'); 
            input.setAttribute('readonly', true);
            input.classList.add(ANIM_CLASSES[id]);
            
            if (container) container.classList.add('container-hidden');
            if (part) part.classList.add('part-activated');

            activatedSet.add(id);
            checkAscension();
        }

        async function checkAscension() {
            if (activatedSet.size === 3) {
                try {
                    const response = await fetch('/api/ascension', {
                        method: 'POST', 
                        headers: { 'Content-Type': 'application/json' }
                    });
                    const data = await response.json();
                    
                    if (data.granted && data.url) {
                        setTimeout(() => {
                            window.location.href = data.url;
                        }, 2500); 
                    }
                } catch (e) {
                    console.error("Ascension Denied:", e);
                }
            }
        }

        setupInputLogic('input-top'); setupInputLogic('input-left'); setupInputLogic('input-right');
        checkTheme(); initRabbitSprites(); SLICES_DATA.forEach((data, i) => wheel.appendChild(createSliceDOM(data, i))); lucide.createIcons(); animate();
    </script>
</body>
</html>
